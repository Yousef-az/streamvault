{
  "version": 3,
  "sources": ["../bundle-9lBNsX/checked-fetch.js", "../../../src/config.ts", "../../../src/utils/helpers.ts", "../../../src/handlers/checkout.ts", "../../../src/utils/email/send-email.ts", "../../../src/utils/email/base-template.ts", "../../../src/utils/email/smart-tv.ts", "../../../src/utils/email/fire-stick.ts", "../../../src/utils/email/android-box.ts", "../../../src/utils/email/ios.ts", "../../../src/utils/email/android-phone.ts", "../../../src/utils/email/web-browser.ts", "../../../src/utils/email/mag-box.ts", "../../../src/utils/email/other.ts", "../../../src/utils/email/index.ts", "../../../src/handlers/activation.ts", "../../../src/handlers/status.ts", "../../../src/handlers/instructions.ts", "../../../src/handlers/webhooks.ts", "../../../src/handlers/cors.ts", "../../../src/handlers/debug.ts", "../../../src/index.ts", "../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-9lBNsX/middleware-insertion-facade.js", "../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-9lBNsX/middleware-loader.entry.ts"],
  "sourceRoot": "/Users/yousef/IdeaProjects/streamvault/.wrangler/tmp/dev-N6AjDL",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "// src/config.ts\nexport const REGIONAL_OPTIONS: Record<string, string> = {\n    north_america: \"bouquet_na\",\n    uk_europe: \"bouquet_eu\",\n    middle_east_arabic: \"bouquet_me\",\n    asia: \"bouquet_asia\",\n    global: \"bouquet_global\",\n};\n\nexport const STRIPE_PRICES: Record<string, string> = {\n    \"1\": \"price_1RAN1mRt8rNloVVOmKvL8NZy\",\n    \"3\": \"price_1RAcdYRt8rNloVVOQ9xQz0S2\",\n    \"6\": \"price_1RAcgVRt8rNloVVOmWWseZbt\",\n    \"12\": \"price_1RAcLVRt8rNloVVOju32toFh\",\n    \"24\": \"price_1RAcRhRt8rNloVVOQclunaHF\"\n};\n\nexport const REGION_CONFIG: Record<string, { display: string; emoji: string }> = {\n    north_america: { display: \"United States (North America)\", emoji: \"\uD83C\uDDFA\uD83C\uDDF8\" },\n    uk_europe: { display: \"Europe / UK\", emoji: \"\uD83C\uDDEA\uD83C\uDDFA\" },\n    middle_east_arabic: { display: \"Middle East / Arabic\", emoji: \"\uD83C\uDDF8\uD83C\uDDE6\" },\n    asia: { display: \"Asia\", emoji: \"\uD83C\uDF0F\" },\n    global: { display: \"Global\", emoji: \"\uD83C\uDF10\" }\n};\n\nexport const DEVICE_CONFIG: Record<string, { label: string; emoji: string }> = {\n    ios: { label: \"Apple Devices\", emoji: \"\uD83C\uDF4E\" },\n    fire_stick: { label: \"Fire Stick\", emoji: \"\uD83D\uDD25\" },\n    android_box: { label: \"Android Box\", emoji: \"\uD83D\uDCE6\" },\n    smart_tv: { label: \"Smart TV\", emoji: \"\uD83D\uDCFA\" },\n    android_phone: { label: \"Android Phone\", emoji: \"\uD83D\uDCF2\" },\n    web_browser: { label: \"Windows PC\", emoji: \"\uD83C\uDF10\" },\n    mag_box: { label: \"MAG Box\", emoji: \"\uD83D\uDCFC\" },\n    other: { label: \"Other\", emoji: \"\u2728\" },\n};\n\nexport const DEVICE_INSTRUCTIONS: Record<string, string> = {\n    smart_tv: `\n    <ol>\n      <li>Press the Home button on your remote</li>\n      <li>Navigate to the app store on your TV</li>\n      <li>Search for and install the \"Smart IPTV\" app</li>\n      <li>Open the Smart IPTV app</li>\n      <li>Navigate to Settings > Configuration</li>\n      <li>Enter your M3U credentials when prompted</li>\n      <li>Save your settings and restart the app</li>\n    </ol>\n    <p><strong>Note:</strong> Some TV models may require a system restart after installation.</p>\n  `,\n    fire_stick: `\n    <ol>\n      <li>From your Fire Stick home screen, search for and install the \"Downloader\" app</li>\n      <li>Open the Downloader app and enter: bit.ly/iptv-player</li>\n      <li>Follow the prompts to install the IPTV player</li>\n      <li>Open the newly installed IPTV player</li>\n      <li>Select \"Add Playlist\" > \"Add M3U URL\"</li>\n      <li>Enter the URL: http://stream.example.com/get.php?username=[YOUR_USERNAME]&password=[YOUR_PASSWORD]&type=m3u_plus&output=ts</li>\n      <li>Replace [YOUR_USERNAME] and [YOUR_PASSWORD] with your credentials</li>\n      <li>Save and enjoy your content</li>\n    </ol>\n  `,\n    android_box: `\n    <ol>\n      <li>Open the Google Play Store on your Android Box</li>\n      <li>Search for and install \"IPTV Smarters Pro\" or \"TiviMate\"</li>\n      <li>Open the installed app</li>\n      <li>Select \"Add Playlist\" or \"Add New Playlist\"</li>\n      <li>Choose \"Add M3U URL\" or \"Add URL\"</li>\n      <li>Enter your playlist URL with your username and password</li>\n      <li>Name your playlist (e.g., \"My IPTV\")</li>\n      <li>Save and enjoy your content</li>\n    </ol>\n    <p><strong>Tip:</strong> For best performance, connect your Android Box via Ethernet instead of Wi-Fi if possible.</p>\n  `,\n    ios: `\n    <ol>\n      <li>Install \"IPTV Smarters Pro\" from the App Store</li>\n      <li>Open the IPTV Smarters Pro app</li>\n      <li>Tap on \"Add New User\"</li>\n      <li>Enter a name for your playlist</li>\n      <li>Select \"M3U URL\" as input type</li>\n      <li>Enter your M3U URL with your credentials</li>\n      <li>Tap \"Add User\" to save</li>\n      <li>Your channels will now load</li>\n    </ol>\n  `,\n    android_phone: `\n    <ol>\n      <li>Install \"IPTV Smarters Pro\" from Google Play Store</li>\n      <li>Open the app and tap \"Add User\"</li>\n      <li>Enter a name for your profile</li>\n      <li>Choose \"M3U URL\" for playlist type</li>\n      <li>Enter your M3U URL with credentials</li>\n      <li>Save your configuration</li>\n      <li>Your channels will load automatically</li>\n    </ol>\n    <p><strong>Note:</strong> For casting to a TV, make sure both devices are on the same Wi-Fi network.</p>\n  `,\n    mag_box: `\n    <ol>\n      <li>Power on your MAG box</li>\n      <li>Go to the Settings menu</li>\n      <li>Select \"System Settings\"</li>\n      <li>Navigate to \"Servers\" or \"Portal Settings\"</li>\n      <li>Enter the portal URL: http://portal.example.com/c/</li>\n      <li>If prompted, restart your MAG box</li>\n      <li>Your channels should now load automatically</li>\n    </ol>\n    <p><strong>Important:</strong> Your MAG box is already registered in our system. If you change your MAG box, please contact support.</p>\n  `,\n    web_browser: `\n    <ol>\n      <li>Open your preferred web browser (Chrome, Firefox, Safari, etc.)</li>\n      <li>Visit: http://watch.blancosphere.com</li>\n      <li>Enter your username and password</li>\n      <li>Click \"Sign In\"</li>\n      <li>Use the navigation menu to browse channels by category</li>\n    </ol>\n    <p><strong>Tip:</strong> Bookmark the page for easy access in the future.</p>\n  `,\n};", "// src/utils/helpers.ts\nimport { Env, StripeSessionResponse } from '../types';\nimport { DEVICE_INSTRUCTIONS } from '../config';\n\n/**\n * Handles errors from a promise and returns a tuple [data, error].\n */\nexport async function handleErrors<T>(promise: Promise<T>): Promise<[T | null, Error | null]> {\n    try {\n        const data = await promise;\n        return [data, null];\n    } catch (error) {\n        return [null, error instanceof Error ? error : new Error(String(error))];\n    }\n}\n\n/**\n * Validates that all required parameters are present.\n */\nexport function validateRequiredParams(params: Record<string, string | null>): string | null {\n    for (const [key, value] of Object.entries(params)) {\n        if (!value) return `Missing required parameter: ${key}`;\n    }\n    return null;\n}\n\n/**\n * Fetches JSON from the Activation Panel API.\n */\nexport async function fetchFromActivationPanel(url: string): Promise<any> {\n    const [response, fetchError] = await handleErrors(fetch(url));\n    if (fetchError) throw new Error(`API request failed: ${fetchError.message}`);\n    if (!response || !response.ok) throw new Error(`API request failed with status: ${response?.status}`);\n    const [data, jsonError] = await handleErrors(response.json());\n    if (jsonError) throw new Error(`Failed to parse API response: ${jsonError.message}`);\n    return data;\n}\n\n/**\n * Creates a standard JSON response.\n */\nexport function createJsonResponse(data: any, status = 200): Response {\n    return new Response(JSON.stringify(data), {\n        status,\n        headers: {\n            \"Content-Type\": \"application/json\",\n            \"Cache-Control\": \"no-store\",\n            \"Access-Control-Allow-Origin\": \"*\",\n        },\n    });\n}\n\n/**\n * Creates an error JSON response.\n */\nexport function createErrorResponse(message: string, status = 400): Response {\n    return createJsonResponse({ error: message }, status);\n}\n\n/**\n * Logs an event to the KV store.\n */\nexport async function logEvent(env: Env, eventType: string, data: Record<string, any>): Promise<void> {\n    try {\n        const timestamp = new Date().toISOString();\n        const logKey = `log:${eventType}:${timestamp}:${crypto.randomUUID()}`;\n        await env.KV.put(logKey, JSON.stringify({ timestamp, eventType, ...data }), { expirationTtl: 2592000 });\n    } catch (error) {\n        console.error(`Failed to log ${eventType} event:`, error);\n    }\n}\n\n/**\n * Extracts credentials from an M3U URL.\n */\nexport function extractCredentials(m3uUrl: string): { username: string; password: string } | null {\n    try {\n        const url = new URL(m3uUrl);\n        const username = url.searchParams.get(\"username\");\n        const password = url.searchParams.get(\"password\");\n        if (!username || !password) throw new Error(\"Missing username or password in URL\");\n        return { username, password };\n    } catch (error) {\n        console.error(\"Failed to extract credentials:\", error);\n        return null;\n    }\n}\n\n/**\n * Processes the Stripe response using a custom session parser.\n */\nexport async function handleStripeResponse(\n    stripeResponse: Response | null,\n    sessionParser: (data: StripeSessionResponse) => any\n): Promise<any> {\n    if (!stripeResponse) throw new Error(\"Failed to connect to Stripe API\");\n    if (!stripeResponse.ok) throw new Error(`Stripe API returned error status: ${stripeResponse.status}`);\n    const [sessionData, sessionError] = await handleErrors<StripeSessionResponse>(stripeResponse.json());\n    if (sessionError) throw new Error(`Failed to parse Stripe response: ${sessionError.message}`);\n    if (!sessionData?.url) throw new Error(\"Stripe session creation failed - missing redirect URL\");\n    return sessionParser(sessionData);\n}\n\n/**\n * Generates a secure random token.\n */\nexport function generateSecureToken(length = 32): string {\n    const array = new Uint8Array(length);\n    crypto.getRandomValues(array);\n    return Array.from(array, byte => byte.toString(16).padStart(2, \"0\")).join(\"\");\n}\n\n/**\n * Verifies a Stripe webhook signature.\n */\nexport function verifyStripeWebhookSignature(payload: string, signature: string, secret: string): boolean {\n    try {\n        // TODO: Implement proper HMAC verification with Stripe's algorithm.\n        console.log(\"Verifying webhook signature:\", { payload: payload.substring(0, 20) + \"...\", signature });\n        return true;\n    } catch (error) {\n        console.error(\"Signature verification error:\", error);\n        return false;\n    }\n}\n\n/**\n * Parses a comma-separated device types string into an array.\n */\nexport function parseDeviceTypes(deviceTypesString: string): string[] {\n    if (!deviceTypesString) return [];\n    return deviceTypesString.split(\",\").map(d => d.trim()).filter(Boolean);\n}\n\n/**\n * Validates that all provided device types are supported.\n */\nexport function validateDeviceTypes(deviceTypes: string[]): string | null {\n    if (!deviceTypes.length) return \"At least one device type must be selected\";\n    const unsupportedDevices = deviceTypes.filter(d => !DEVICE_INSTRUCTIONS[d]);\n    return unsupportedDevices.length ? `Unsupported device type(s): ${unsupportedDevices.join(\", \")}` : null;\n}\n\n/**\n * Formats device type names for display.\n */\nexport function formatDeviceName(deviceType: string): string {\n    return deviceType\n        .split(\"_\")\n        .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n        .join(\" \");\n}\n\n/**\n * Validates the x-api-key header against the STREAMVAULT_ADMIN_KEY.\n */\nexport function validateApiKey(request: Request, env: Env): boolean {\n    const apiKey = request.headers.get(\"x-api-key\");\n    return apiKey === env.STREAMVAULT_ADMIN_KEY;\n}\n", "// handlers/checkout.ts\nimport { Env, SubscriptionSelection } from '../types';\nimport {\n    createErrorResponse,\n    createJsonResponse,\n    generateSecureToken,\n    handleErrors,\n    handleStripeResponse,\n    logEvent,\n    parseDeviceTypes,\n    validateDeviceTypes,\n    validateRequiredParams\n} from '../utils/helpers';\nimport { REGIONAL_OPTIONS, STRIPE_PRICES } from '../config';\n\n/**\n * Creates a Stripe Checkout session based on the subscription selection.\n */\nexport async function handleCreateCheckout(request: Request, env: Env): Promise<Response> {\n    try {\n        const [body, parseError] = await handleErrors(request.json());\n        if (parseError) return createErrorResponse(`Invalid request body: ${parseError.message}`, 400);\n\n        const rawSelection = body as any;\n        const deviceTypes = Array.isArray(rawSelection.device_types)\n            ? rawSelection.device_types\n            : parseDeviceTypes(rawSelection.device_types || \"\");\n\n        const selection: SubscriptionSelection = {\n            subscriptionLength: rawSelection.subscriptionLength,\n            region: rawSelection.region,\n            customer_id: rawSelection.customer_id || generateSecureToken(12),\n            device_types: deviceTypes,\n            user_email: rawSelection.user_email,\n        };\n\n        const validationError = validateRequiredParams({\n            subscriptionLength: selection.subscriptionLength,\n            region: selection.region,\n            user_email: selection.user_email,\n        });\n        if (validationError) return createErrorResponse(validationError, 400);\n\n        const deviceTypesError = validateDeviceTypes(selection.device_types);\n        if (deviceTypesError) return createErrorResponse(deviceTypesError, 400);\n\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(selection.user_email)) {\n            return createErrorResponse(\"Invalid email format\", 400);\n        }\n\n        const bouquetSelection = REGIONAL_OPTIONS[selection.region];\n        if (!bouquetSelection) return createErrorResponse(`Invalid region: ${selection.region}`, 400);\n\n        const successUrl = new URL(\"https://iptv-unified-worker.yousef-az.workers.dev/activate\");\n        successUrl.searchParams.set(\"subscriptionLength\", selection.subscriptionLength);\n        successUrl.searchParams.set(\"region\", selection.region);\n        successUrl.searchParams.set(\"customer_id\", selection.customer_id);\n        successUrl.searchParams.set(\"device_types\", selection.device_types.join(\",\"));\n        successUrl.searchParams.set(\"user_email\", selection.user_email);\n\n        const checkoutToken = generateSecureToken();\n        successUrl.searchParams.set(\"checkoutToken\", checkoutToken);\n        await env.KV.put(`checkout:${checkoutToken}`, JSON.stringify({ selection, timestamp: Date.now() }), { expirationTtl: 3600 });\n\n        const stripePriceId = STRIPE_PRICES[selection.subscriptionLength];\n        if (!stripePriceId) return createErrorResponse(`Invalid subscription length: ${selection.subscriptionLength}`, 400);\n\n        const formParams = new URLSearchParams({\n            success_url: successUrl.toString(),\n            cancel_url: \"https://blancosphere.com/canceled\",\n            mode: \"subscription\",\n            \"line_items[0][price]\": stripePriceId,\n            \"line_items[0][quantity]\": \"1\",\n            customer_email: selection.user_email,\n        });\n\n        formParams.append(\"metadata[subscriptionLength]\", selection.subscriptionLength.toString());\n        formParams.append(\"metadata[region]\", selection.region);\n        formParams.append(\"metadata[device_types]\", selection.device_types.join(\",\"));\n        formParams.append(\"metadata[plan]\", \"launch\");\n        formParams.append(\"metadata[bouquet]\", bouquetSelection);\n        formParams.append(\"metadata[checkout_token]\", checkoutToken);\n\n        await logEvent(env, \"checkout_initiated\", {\n            customer_id: selection.customer_id,\n            user_email: selection.user_email,\n            region: selection.region,\n            subscriptionLength: selection.subscriptionLength,\n            device_types: selection.device_types,\n        });\n\n        const [stripeResponse, stripeError] = await handleErrors(fetch(\"https://api.stripe.com/v1/checkout/sessions\", {\n            method: \"POST\",\n            headers: {\n                Authorization: `Bearer ${env.STRIPE_SECRET_KEY}`,\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\n            },\n            body: formParams,\n        }));\n\n        if (stripeError) {\n            console.error(\"Stripe API error:\", stripeError);\n            await logEvent(env, \"checkout_error\", { customer_id: selection.customer_id, error: stripeError.message });\n            return createErrorResponse(\"Failed to create Stripe checkout session\", 500);\n        }\n\n        try {\n            const sessionData = await handleStripeResponse(stripeResponse, (data) => ({\n                url: data.url,\n                session_id: data.id,\n            }));\n            await logEvent(env, \"checkout_created\", { customer_id: selection.customer_id, session_id: sessionData.session_id });\n            return createJsonResponse(sessionData);\n        } catch (error) {\n            return createErrorResponse(`Stripe session error: ${error instanceof Error ? error.message : String(error)}`, 500);\n        }\n    } catch (err) {\n        console.error(\"Unexpected error in handleCreateCheckout:\", err);\n        return createErrorResponse(`Internal server error: ${err instanceof Error ? err.message : String(err)}`, 500);\n    }\n}\n", "// src/utils/email/send-email.ts\nimport { Env } from '../../types';\n\n/**\n * Sends an email using SendGrid.\n *\n * @param env - Environment variables containing the SendGrid API key\n * @param toEmail - Recipient email address\n * @param subject - Email subject line\n * @param htmlContent - HTML content of the email\n * @param fromEmail - Optional sender email (defaults to support@blancosphere.com)\n * @param fromName - Optional sender name (defaults to Blancosphere Support)\n * @param replyTo - Optional reply-to email address\n * @param attachments - Optional array of attachments\n * @returns Promise that resolves when email is sent successfully\n * @throws Error if SendGrid API returns an error\n */\nexport async function sendEmail(\n    env: Env,\n    toEmail: string,\n    subject: string,\n    htmlContent: string,\n    fromEmail: string = \"support@blancosphere.com\",\n    fromName: string = \"Blancosphere Support\",\n    replyTo?: string,\n    attachments?: Array<{\n        content: string;\n        filename: string;\n        type: string;\n        disposition: \"attachment\" | \"inline\";\n        content_id?: string;\n    }>\n) {\n    const url = \"https://api.sendgrid.com/v3/mail/send\";\n\n    // Build request body\n    const body: any = {\n        personalizations: [{ to: [{ email: toEmail }], subject }],\n        from: { email: fromEmail, name: fromName },\n        content: [{ type: \"text/html\", value: htmlContent }],\n    };\n\n    // Add optional parameters if provided\n    if (replyTo) {\n        body.reply_to = { email: replyTo };\n    }\n\n    if (attachments && attachments.length > 0) {\n        body.attachments = attachments;\n    }\n\n    // Send the request\n    const response = await fetch(url, {\n        method: \"POST\",\n        headers: {\n            Authorization: `Bearer ${env.SENDGRID_API_KEY}`,\n            \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(body),\n    });\n\n    // Handle errors\n    if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(`SendGrid Error: ${response.status} - ${errorText}`);\n    }\n\n    return response;\n}", "// src/utils/email/base-template.ts\nimport { Env } from '../../types';\nimport { REGION_CONFIG, DEVICE_CONFIG } from '../../config';\nimport { formatDeviceName } from '../helpers';\n\n/**\n * Creates a base email template with all common elements that will be used across device-specific templates.\n *\n * @param deviceType - Type of device (e.g., \"android\", \"ios\", \"smart_tv\", \"mag\")\n * @param username - User's login username\n * @param password - User's login password\n * @param region - Content region (e.g., \"north_america\", \"uk_europe\", etc.)\n * @param subscriptionLength - Length of subscription in months (e.g., \"1\", \"3\", \"6\", \"12\")\n * @param isRenewal - Whether this is a renewal or new subscription\n * @param deviceSpecificInstructions - HTML string with device-specific setup instructions\n * @param deviceSpecificTip - HTML string with device-specific tip (optional)\n * @param portalUrl - Optional URL to customer portal\n * @param firstName - Optional first name of customer\n * @param serverDomain - Server domain for M3U URL (default: \"iptv.blancosphere.com\")\n * @returns HTML content for email body\n */\nexport function createBaseEmailTemplate(\n    deviceType: string,\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    deviceSpecificInstructions: string,\n    deviceSpecificTip?: string,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    // Get device-specific configurations\n    const regionDisplayName = REGION_CONFIG[region]?.display || region;\n    const regionEmoji = REGION_CONFIG[region]?.emoji || \"\uD83C\uDF0D\";\n    const deviceEmoji = DEVICE_CONFIG[deviceType]?.emoji || \"\uD83D\uDCF1\";\n    const deviceTypeDisplay = DEVICE_CONFIG[deviceType]?.label || formatDeviceName(deviceType);\n\n    // Calculate dates and format URLs\n    const expiryDate = new Date(Date.now() + parseInt(subscriptionLength) * 30 * 24 * 60 * 60 * 1000);\n    const formattedExpiryDate = expiryDate.toLocaleDateString(\"en-US\", { year: \"numeric\", month: \"long\", day: \"numeric\" });\n    const currentDate = new Date().toLocaleDateString(\"en-US\", { weekday: \"long\", year: \"numeric\", month: \"long\", day: \"numeric\" });\n    const currentYear = new Date().getFullYear();\n    const m3uUrl = `http://${serverDomain}/get.php?username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}&type=m3u_plus&output=ts`;\n    const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(m3uUrl)}&size=150x150`;\n    const greeting = firstName ? `Hello ${firstName},` : \"Hello,\";\n\n    // Default device-specific tip if none provided\n    const tipContent = deviceSpecificTip || `For the best streaming experience, use a stable internet connection with at least 10 Mbps download speed and consider using a wired connection when possible.`;\n\n    return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <meta name=\"color-scheme\" content=\"light dark\">\n  <meta name=\"supported-color-schemes\" content=\"light dark\">\n  <title>Your ${deviceTypeDisplay} Access Activated</title>\n  <style>\n    :root {\n      color-scheme: light dark;\n      supported-color-schemes: light dark;\n    }\n    \n    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');\n    \n    body {\n      font-family: 'Inter', sans-serif;\n      line-height: 1.6;\n      color: #2B3241;\n      background-color: #F1F5F9;\n      margin: 0;\n      padding: 0;\n    }\n    \n    .email-container {\n      max-width: 640px;\n      margin: 0 auto;\n      background: linear-gradient(180deg, #FFFFFF 0%, #F9FAFC 100%);\n      border-radius: 24px;\n      overflow: hidden;\n      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);\n    }\n    \n    .header {\n      position: relative;\n      background: linear-gradient(125deg, #0F172A 0%, #1E293B 100%);\n      padding: 60px 0 140px;\n      text-align: center;\n      color: white;\n      overflow: hidden;\n    }\n    \n    .header-glow {\n      position: absolute;\n      width: 600px;\n      height: 600px;\n      background: radial-gradient(circle, rgba(56, 189, 248, 0.15) 0%, rgba(56, 189, 248, 0) 70%);\n      top: -200px;\n      left: 50%;\n      transform: translateX(-50%);\n      z-index: 0;\n    }\n    \n    .header-particles {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-image: url(\"data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='10' cy='10' r='1' fill='%23FFFFFF' fill-opacity='0.1'/%3E%3Ccircle cx='30' cy='40' r='1' fill='%23FFFFFF' fill-opacity='0.1'/%3E%3Ccircle cx='50' cy='20' r='1' fill='%23FFFFFF' fill-opacity='0.1'/%3E%3Ccircle cx='70' cy='70' r='1' fill='%23FFFFFF' fill-opacity='0.1'/%3E%3Ccircle cx='90' cy='30' r='1' fill='%23FFFFFF' fill-opacity='0.1'/%3E%3Ccircle cx='20' cy='80' r='1' fill='%23FFFFFF' fill-opacity='0.1'/%3E%3Ccircle cx='60' cy='50' r='1' fill='%23FFFFFF' fill-opacity='0.1'/%3E%3Ccircle cx='80' cy='10' r='1' fill='%23FFFFFF' fill-opacity='0.1'/%3E%3C/svg%3E\");\n      opacity: 0.4;\n      z-index: 1;\n    }\n    \n    .logo-container {\n      position: relative;\n      z-index: 2;\n      margin-bottom: 30px;\n    }\n    \n    .logo {\n      width: 80px;\n      height: 80px;\n      background-color: white;\n      border-radius: 50%;\n      padding: 15px;\n      box-shadow: 0 0 0 10px rgba(255, 255, 255, 0.1);\n    }\n    \n    .header-title {\n      position: relative;\n      z-index: 2;\n      font-size: 28px;\n      font-weight: 700;\n      margin: 0;\n      padding: 0 20px;\n      letter-spacing: -0.5px;\n    }\n    \n    .header-subtitle {\n      position: relative;\n      z-index: 2;\n      font-size: 16px;\n      font-weight: 400;\n      opacity: 0.8;\n      margin: 15px 0 0;\n    }\n    \n    .status-badge {\n      position: relative;\n      z-index: 2;\n      display: inline-flex;\n      align-items: center;\n      background: rgba(56, 189, 248, 0.2);\n      backdrop-filter: blur(10px);\n      -webkit-backdrop-filter: blur(10px);\n      border: 1px solid rgba(56, 189, 248, 0.3);\n      color: #38BDF8;\n      font-size: 14px;\n      font-weight: 600;\n      padding: 8px 16px;\n      border-radius: 100px;\n      margin-top: 20px;\n    }\n    \n    .status-badge::before {\n      content: \"\";\n      display: inline-block;\n      width: 8px;\n      height: 8px;\n      background-color: #38BDF8;\n      border-radius: 50%;\n      margin-right: 8px;\n      animation: pulse 2s infinite;\n    }\n    \n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.7);\n      }\n      70% {\n        box-shadow: 0 0 0 6px rgba(56, 189, 248, 0);\n      }\n      100% {\n        box-shadow: 0 0 0 0 rgba(56, 189, 248, 0);\n      }\n    }\n    \n    .content-wrapper {\n      position: relative;\n      margin-top: -80px;\n      padding: 0 30px 50px;\n      z-index: 10;\n    }\n    \n    .content {\n      background: rgba(255, 255, 255, 0.9);\n      backdrop-filter: blur(20px);\n      -webkit-backdrop-filter: blur(20px);\n      border: 1px solid rgba(255, 255, 255, 0.7);\n      border-radius: 24px;\n      padding: 40px;\n      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.06);\n    }\n    \n    .greeting {\n      font-size: 18px;\n      font-weight: 600;\n      color: #0F172A;\n      margin-top: 0;\n      margin-bottom: 20px;\n    }\n    \n    .intro-text {\n      font-size: 16px;\n      line-height: 1.7;\n      color: #475569;\n      margin-bottom: 30px;\n    }\n    \n    .section {\n      margin-bottom: 40px;\n    }\n    \n    .section-title {\n      display: flex;\n      align-items: center;\n      font-size: 18px;\n      font-weight: 600;\n      color: #0F172A;\n      margin-bottom: 20px;\n    }\n    \n    .section-icon {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 36px;\n      height: 36px;\n      background: linear-gradient(135deg, #38BDF8 0%, #0EA5E9 100%);\n      border-radius: 10px;\n      margin-right: 12px;\n      color: white;\n      font-size: 18px;\n    }\n    \n// For the credential cards, ensure the grid styling is consistent:\n.credentials-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 30px;\n  margin-top: 30px;\n  width: 100%; /* Add this to ensure full width */\n}\n    \n.credential-card {\n  background: #F8FAFC;\n  border-radius: 16px;\n  padding: 24px;\n  border: 1px solid #E2E8F0;\n  transition: all 0.3s ease;\n  width: 100%; /* Add this to ensure full width */\n  box-sizing: border-box; /* Add this to include padding in width calculation */\n}\n    \n    .credential-card:hover {\n      transform: translateY(-5px);\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);\n      border-color: #CBD5E1;\n    }\n    \n    .credential-label {\n      display: flex;\n      align-items: center;\n      font-size: 14px;\n      font-weight: 500;\n      color: #64748B;\n      margin-bottom: 10px;\n    }\n    \n    .credential-icon {\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      width: 24px;\n      height: 24px;\n      background: #E2E8F0;\n      border-radius: 6px;\n      margin-right: 8px;\n    }\n    \n// For the subscription text that appears to have a line break issue:\n.credential-value {\n  font-family: 'SF Mono', 'Consolas', monospace;\n  font-size: 16px;\n  font-weight: 500;\n  color: #0F172A;\n  background: white;\n  padding: 12px 16px;\n  border-radius: 12px;\n  border: 1px solid #E2E8F0;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02);\n  word-break: break-word; /* Add this to handle long text */\n  white-space: normal; /* Add this to allow wrapping */\n}\n    \n    .qr-container {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n      margin: 30px 0;\n      padding: 30px;\n      background: #F8FAFC;\n      border-radius: 16px;\n      border: 1px solid #E2E8F0;\n    }\n    \n    .qr-code {\n      width: 150px;\n      height: 150px;\n      padding: 10px;\n      background: white;\n      border-radius: 16px;\n      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);\n      margin-bottom: 15px;\n    }\n    \n    .qr-caption {\n      font-size: 14px;\n      color: #64748B;\n      font-weight: 500;\n      text-align: center;\n    }\n    \n    .m3u-url {\n      font-size: 13px;\n      color: #64748B;\n      background: white;\n      padding: 10px 15px;\n      border-radius: 8px;\n      border: 1px solid #E2E8F0;\n      margin-top: 12px;\n      word-break: break-all;\n      text-align: center;\n      max-width: 300px;\n    }\n    \n    .steps-container {\n      background: #F8FAFC;\n      border-radius: 16px;\n      padding: 30px;\n      border: 1px solid #E2E8F0;\n    }\n    \n    .steps-list {\n      list-style-type: none;\n      counter-reset: steps-counter;\n      margin: 0;\n      padding: 0;\n    }\n    \n    .step-item {\n      position: relative;\n      padding-left: 50px;\n      margin-bottom: 20px;\n      counter-increment: steps-counter;\n    }\n    \n    .step-item:last-child {\n      margin-bottom: 0;\n    }\n    \n    .step-item::before {\n      content: counter(steps-counter);\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #38BDF8 0%, #0EA5E9 100%);\n      border-radius: 50%;\n      color: white;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-weight: 600;\n      font-size: 14px;\n    }\n    \n    .step-item:not(:last-child)::after {\n      content: \"\";\n      position: absolute;\n      left: 16px;\n      top: 32px;\n      bottom: -12px;\n      width: 1px;\n      background: #E2E8F0;\n    }\n    \n    .step-content {\n      font-size: 15px;\n      color: #475569;\n      line-height: 1.7;\n    }\n    \n    .tip-box {\n      margin-top: 20px;\n      background: rgba(56, 189, 248, 0.1);\n      border-left: 3px solid #38BDF8;\n      padding: 15px 20px;\n      border-radius: 8px;\n      font-size: 14px;\n      color: #0F172A;\n    }\n    \n    .tip-title {\n      font-weight: 600;\n      color: #0EA5E9;\n      display: flex;\n      align-items: center;\n      margin-bottom: 5px;\n    }\n    \n    .tip-title svg {\n      margin-right: 8px;\n    }\n    \n    .warning-box {\n      background: rgba(244, 63, 94, 0.05);\n      border-left: 3px solid #F43F5E;\n      padding: 20px;\n      border-radius: 12px;\n      margin: 30px 0;\n      display: flex;\n      align-items: flex-start;\n      gap: 15px;\n    }\n    \n    .warning-icon {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      min-width: 40px;\n      height: 40px;\n      background: rgba(244, 63, 94, 0.1);\n      border-radius: 50%;\n      color: #F43F5E;\n      font-size: 20px;\n    }\n    \n    .warning-content {\n      flex: 1;\n    }\n    \n    .warning-title {\n      font-weight: 600;\n      color: #F43F5E;\n      margin: 0 0 5px;\n      font-size: 16px;\n    }\n    \n    .warning-text {\n      margin: 0;\n      color: #475569;\n      font-size: 14px;\n      line-height: 1.6;\n    }\n    \n    .tips-grid {\n      display: grid;\n      grid-template-columns: repeat(2, 1fr);\n      gap: 15px;\n      margin-top: 20px;\n    }\n    \n    .tip-card {\n      background: white;\n      border-radius: 12px;\n      padding: 20px;\n      border: 1px solid #E2E8F0;\n    }\n    \n    .tip-card-title {\n      display: flex;\n      align-items: center;\n      font-weight: 600;\n      font-size: 15px;\n      color: #0F172A;\n      margin-bottom: 10px;\n    }\n    \n    .tip-card-icon {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 30px;\n      height: 30px;\n      min-width: 30px;\n      background: #F1F5F9;\n      border-radius: 8px;\n      margin-right: 10px;\n    }\n    \n    .tip-card-text {\n      font-size: 14px;\n      color: #64748B;\n      line-height: 1.6;\n      margin: 0;\n    }\n    \n    .action-container {\n      text-align: center;\n      margin: 40px 0 20px;\n    }\n    \n    .action-button {\n      display: inline-block;\n      background: linear-gradient(135deg, #38BDF8 0%, #0EA5E9 100%);\n      color: white;\n      font-weight: 600;\n      font-size: 16px;\n      text-decoration: none;\n      padding: 16px 32px;\n      border-radius: 100px;\n      box-shadow: 0 10px 25px rgba(14, 165, 233, 0.3);\n      transition: all 0.3s ease;\n      position: relative;\n      overflow: hidden;\n    }\n    \n    .action-button::after {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      height: 100%;\n      background: linear-gradient(to bottom, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0) 100%);\n      transition: all 0.3s ease;\n    }\n    \n    .action-button:hover {\n      transform: translateY(-3px);\n      box-shadow: 0 15px 30px rgba(14, 165, 233, 0.4);\n    }\n    \n    .action-button:hover::after {\n      opacity: 0.5;\n    }\n    \n    .closing {\n      text-align: center;\n      margin-top: 40px;\n      padding-top: 40px;\n      border-top: 1px solid #E2E8F0;\n    }\n    \n    .closing-text {\n      color: #64748B;\n      font-size: 15px;\n      line-height: 1.7;\n      margin-bottom: 20px;\n    }\n    \n    .signature {\n      font-weight: 600;\n      color: #0F172A;\n      font-size: 16px;\n    }\n    \n    .footer {\n      background: #0F172A;\n      padding: 40px 20px;\n      text-align: center;\n      color: white;\n    }\n    \n    .social-links {\n      display: flex;\n      justify-content: center;\n      gap: 15px;\n      margin-bottom: 25px;\n    }\n    \n    .social-link {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 40px;\n      height: 40px;\n      background: rgba(255, 255, 255, 0.1);\n      border-radius: 50%;\n      color: white;\n      text-decoration: none;\n      transition: all 0.3s ease;\n    }\n    \n    .social-link:hover {\n      background: rgba(255, 255, 255, 0.2);\n      transform: translateY(-3px);\n    }\n    \n    .footer-nav {\n      margin: 20px 0;\n    }\n    \n    .footer-link {\n      color: rgba(255, 255, 255, 0.7);\n      text-decoration: none;\n      margin: 0 10px;\n      font-size: 14px;\n      transition: color 0.3s ease;\n    }\n    \n    .footer-link:hover {\n      color: white;\n    }\n    \n    .footer-contact {\n      color: rgba(255, 255, 255, 0.7);\n      font-size: 14px;\n      margin-bottom: 20px;\n    }\n    \n    .footer-contact a {\n      color: #38BDF8;\n      text-decoration: none;\n    }\n    \n    .copyright {\n      font-size: 13px;\n      color: rgba(255, 255, 255, 0.5);\n    }\n    \n    /* Animated elements */\n    @keyframes fadeIn {\n      from { opacity: 0; transform: translateY(10px); }\n      to { opacity: 1; transform: translateY(0); }\n    }\n    \n    .animated {\n      animation: fadeIn 0.5s ease forwards;\n    }\n    \n    .delay-1 { animation-delay: 0.1s; }\n    .delay-2 { animation-delay: 0.2s; }\n    .delay-3 { animation-delay: 0.3s; }\n    .delay-4 { animation-delay: 0.4s; }\n    \n    /* Dark mode styles */\n    @media (prefers-color-scheme: dark) {\n      body {\n        background-color: #0F172A;\n        color: #E2E8F0;\n      }\n      \n      .email-container {\n        background: linear-gradient(180deg, #1E293B 0%, #0F172A 100%);\n      }\n      \n      .header {\n        background: linear-gradient(125deg, #0F172A 0%, #0A101E 100%);\n      }\n      \n      .content {\n        background: rgba(30, 41, 59, 0.9);\n        border-color: rgba(30, 41, 59, 0.7);\n      }\n      \n      .greeting {\n        color: #F8FAFC;\n      }\n      \n      .intro-text {\n        color: #CBD5E1;\n      }\n      \n      .section-title {\n        color: #F8FAFC;\n      }\n      \n      .credential-card {\n        background: #1E293B;\n        border-color: #334155;\n      }\n      \n      .credential-label {\n        color: #94A3B8;\n      }\n      \n      .credential-icon {\n        background: #334155;\n      }\n      \n      .credential-value {\n        color: #F8FAFC;\n        background: #0F172A;\n        border-color: #334155;\n      }\n      \n      .qr-container, .steps-container {\n        background: #1E293B;\n        border-color: #334155;\n      }\n      \n      .qr-code {\n        background: #0F172A;\n      }\n      \n      .qr-caption {\n        color: #94A3B8;\n      }\n      \n      .m3u-url {\n        color: #94A3B8;\n        background: #0F172A;\n        border-color: #334155;\n      }\n      \n      .step-content {\n        color: #CBD5E1;\n      }\n      \n      .step-item:not(:last-child)::after {\n        background: #334155;\n      }\n      \n      .tip-box {\n        background: rgba(56, 189, 248, 0.1);\n        color: #CBD5E1;\n      }\n      \n      .tip-card {\n        background: #1E293B;\n        border-color: #334155;\n      }\n      \n      .tip-card-title {\n        color: #F8FAFC;\n      }\n      \n      .tip-card-icon {\n        background: #0F172A;\n      }\n      \n      .tip-card-text {\n        color: #94A3B8;\n      }\n      \n      .warning-text {\n        color: #CBD5E1;\n      }\n      \n      .closing {\n        border-color: #334155;\n      }\n      \n      .closing-text {\n        color: #94A3B8;\n      }\n      \n      .signature {\n        color: #F8FAFC;\n      }\n    }\n    \n    /* Mobile responsiveness */\n    @media (max-width: 640px) {\n      .header {\n        padding: 40px 0 120px;\n      }\n      \n      .content-wrapper {\n        padding: 0 15px 30px;\n      }\n      \n      .content {\n        padding: 30px 20px;\n      }\n      \n      .credentials-grid,\n      .tips-grid {\n        grid-template-columns: 1fr;\n      }\n      \n      .warning-box {\n        flex-direction: column;\n        align-items: center;\n        text-align: center;\n      }\n      \n      .action-button {\n        width: 100%;\n      }\n      \n      .social-links {\n        flex-wrap: wrap;\n      }\n      \n      .footer-link {\n        display: block;\n        margin: 10px 0;\n      }\n    }\n  </style>\n</head>\n<body>\n  <div class=\"email-container\">\n    <div class=\"header\">\n      <div class=\"header-glow\"></div>\n      <div class=\"header-particles\"></div>\n      \n      <div class=\"logo-container\">\n        <img src=\"http://cdn.mcauto-images-production.sendgrid.net/429455c8921109b6/93d072ea-9630-4bcd-a5dc-109486957cdb/1200x1200.png\" alt=\"Blancosphere\" class=\"logo\">\n      </div>\n      \n      <h1 class=\"header-title\">${isRenewal ? 'Subscription Renewed' : 'Premium Access Activated'}</h1>\n      <p class=\"header-subtitle\">Your gateway to unlimited entertainment</p>\n      \n      <div class=\"status-badge\">Active \u2022 Premium ${deviceTypeDisplay} Access</div>\n    </div>\n    \n    <div class=\"content-wrapper\">\n      <div class=\"content\">\n        <p class=\"greeting animated\">${greeting}</p>\n        \n        <p class=\"intro-text animated delay-1\">\n          ${isRenewal\n        ? `Your premium subscription has been successfully renewed. You continue to have unlimited access to thousands of channels and on-demand content.`\n        : `Your premium subscription has been successfully activated. You now have unlimited access to thousands of live channels, on-demand content, and exclusive premium features.`}\n        </p>\n        \n        <div class=\"section animated delay-2\">\n          <div class=\"section-title\">\n            <div class=\"section-icon\">\uD83D\uDD10</div>\n            Access Credentials\n          </div>\n          \n          <div class=\"credentials-grid\">\n            <div class=\"credential-card\">\n              <div class=\"credential-label\">\n                <div class=\"credential-icon\">\uD83D\uDC64</div>\n                Username\n              </div>\n              <div class=\"credential-value\">${username}</div>\n            </div>\n            \n            <div class=\"credential-card\">\n              <div class=\"credential-label\">\n                <div class=\"credential-icon\">\uD83D\uDD11</div>\n                Password\n              </div>\n              <div class=\"credential-value\">${password}</div>\n            </div>\n            \n            <div class=\"credential-card\">\n              <div class=\"credential-label\">\n                <div class=\"credential-icon\">${regionEmoji}</div>\n                Region\n              </div>\n              <div class=\"credential-value\">${regionDisplayName}</div>\n            </div>\n            \n            <div class=\"credential-card\">\n              <div class=\"credential-label\">\n                <div class=\"credential-icon\">\u23F3</div>\n                Subscription\n              </div>\n              <div class=\"credential-value\">${subscriptionLength} months (Expires: ${formattedExpiryDate})</div>\n            </div>\n          </div>\n          \n          <div class=\"qr-container\">\n            <img src=\"${qrCodeUrl}\" alt=\"QR Code\" class=\"qr-code\">\n            <div class=\"qr-caption\">Scan to automatically connect on mobile devices</div>\n            <div class=\"m3u-url\">${m3uUrl}</div>\n          </div>\n        </div>\n        \n        <div class=\"section animated delay-3\">\n          <div class=\"section-title\">\n            <div class=\"section-icon\">${deviceEmoji}</div>\n            Setup Instructions for ${deviceTypeDisplay}\n          </div>\n          \n          <div class=\"steps-container\">\n            ${deviceSpecificInstructions}\n            \n            <div class=\"tip-title\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z\" stroke=\"#0EA5E9\" stroke-width=\"2\"/>\n                  <path d=\"M12 8V12\" stroke=\"#0EA5E9\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n                  <path d=\"M12 16H12.01\" stroke=\"#0EA5E9\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n                </svg>\n                Pro Tip\n              </div>\n              ${tipContent}\n            </div>\n          </div>\n          \n          <div class=\"warning-box\">\n            <div class=\"warning-icon\">\u26A0\uFE0F</div>\n            <div class=\"warning-content\">\n              <h4 class=\"warning-title\">Important</h4>\n              <p class=\"warning-text\">For your security, never share your credentials with anyone. Your subscription is for personal use only and sharing access may result in account termination.</p>\n            </div>\n          </div>\n          \n          <div class=\"tips-grid\">\n            <div class=\"tip-card\">\n              <div class=\"tip-card-title\">\n                <div class=\"tip-card-icon\">\uD83D\uDCFA</div>\n                Optimal Quality\n              </div>\n              <p class=\"tip-card-text\">Set your player to \"Auto\" quality for the best balance between quality and streaming stability.</p>\n            </div>\n            \n            <div class=\"tip-card\">\n              <div class=\"tip-card-title\">\n                <div class=\"tip-card-icon\">\uD83D\uDCF1</div>\n                Multi-device Access\n              </div>\n              <p class=\"tip-card-text\">You can use your subscription on multiple devices, but simultaneous streaming is limited to 1 device at a time.</p>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"action-container animated delay-4\">\n          ${portalUrl ?\n        `<a href=\"${portalUrl}\" class=\"action-button\">Access Your Customer Portal</a>` :\n        '<!-- No portal URL provided -->'\n    }\n        </div>\n        \n        <div class=\"closing animated delay-4\">\n          <p class=\"closing-text\">If you have any questions or need assistance, our support team is available 24/7. Simply reply to this email or contact us through the customer portal.</p>\n          <p class=\"signature\">The Blancosphere Team</p>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"footer\">\n      <div class=\"social-links\">\n        <a href=\"#\" class=\"social-link\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M18 2H15C13.6739 2 12.4021 2.52678 11.4645 3.46447C10.5268 4.40215 10 5.67392 10 7V10H7V14H10V22H14V14H17L18 10H14V7C14 6.73478 14.1054 6.48043 14.2929 6.29289C14.4804 6.10536 14.7348 6 15 6H18V2Z\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n        </a>\n        <a href=\"#\" class=\"social-link\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M23 3.00005C22.0424 3.67552 20.9821 4.19216 19.86 4.53005C19.2577 3.83756 18.4573 3.34674 17.567 3.12397C16.6767 2.90121 15.7395 2.95724 14.8821 3.2845C14.0247 3.61176 13.2884 4.19445 12.773 4.95376C12.2575 5.71308 11.9877 6.61238 12 7.53005V8.53005C10.2426 8.57561 8.50127 8.18586 6.93101 7.39549C5.36074 6.60513 4.01032 5.43868 3 4.00005C3 4.00005 -1 13 8 17C5.94053 18.398 3.48716 19.099 1 19C10 24 21 19 21 7.50005C20.9991 7.2215 20.9723 6.94364 20.92 6.67005C21.9406 5.66354 22.6608 4.39276 23 3.00005Z\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n        </a>\n        <a href=\"#\" class=\"social-link\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M17 2H7C4.23858 2 2 4.23858 2 7V17C2 19.7614 4.23858 22 7 22H17C19.7614 22 22 19.7614 22 17V7C22 4.23858 19.7614 2 17 2Z\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            <path d=\"M16 11.3701C16.1234 12.2023 15.9813 13.0523 15.5938 13.7991C15.2063 14.5459 14.5932 15.1515 13.8416 15.5297C13.0901 15.908 12.2385 16.0397 11.4078 15.906C10.5771 15.7723 9.80977 15.3801 9.21484 14.7852C8.61991 14.1903 8.22773 13.4229 8.09406 12.5923C7.9604 11.7616 8.09206 10.91 8.47032 10.1584C8.84858 9.40691 9.45418 8.7938 10.201 8.4063C10.9478 8.0188 11.7978 7.87665 12.63 8.00006C13.4789 8.12594 14.2649 8.52152 14.8717 9.12836C15.4785 9.73521 15.8741 10.5211 16 11.3701Z\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            <path d=\"M17.5 6.5H17.51\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n        </a>\n        <a href=\"#\" class=\"social-link\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M16 8C17.5913 8 19.1174 8.63214 20.2426 9.75736C21.3679 10.8826 22 12.4087 22 14V21H18V14C18 13.4696 17.7893 12.9609 17.4142 12.5858C17.0391 12.2107 16.5304 12 16 12C15.4696 12 14.9609 12.2107 14.5858 12.5858C14.2107 12.9609 14 13.4696 14 14V21H10V14C10 12.4087 10.6321 10.8826 11.7574 9.75736C12.8826 8.63214 14.4087 8 16 8Z\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            <path d=\"M6 9H2V21H6V9Z\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            <path d=\"M4 6C5.10457 6 6 5.10457 6 4C6 2.89543 5.10457 2 4 2C2.89543 2 2 2.89543 2 4C2 5.10457 2.89543 6 4 6Z\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n        </a>\n      </div>\n      \n      <div class=\"footer-nav\">\n        <a href=\"#\" class=\"footer-link\">Help Center</a>\n        <a href=\"#\" class=\"footer-link\">Terms of Service</a>\n        <a href=\"#\" class=\"footer-link\">Privacy Policy</a>\n        <a href=\"#\" class=\"footer-link\">Refund Policy</a>\n      </div>\n      \n      <div class=\"footer-contact\">\n        Need help? Email us at <a href=\"mailto:support@blancosphere.com\">support@blancosphere.com</a>\n      </div>\n      \n      <div class=\"copyright\">\n        &copy; ${currentYear} Blancosphere. All rights reserved. Sent on ${currentDate}.\n      </div>\n    </div>\n  </div>\n</body>\n</html>`;\n}", "// src/utils/email/smart-tv.ts\nimport { createBaseEmailTemplate } from './base-template';\n\n/**\n * Builds a Smart TV specific email template\n */\nexport function buildSmartTvEmailTemplate(\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const deviceSpecificInstructions = `\n    <ol class=\"steps-list\">\n      <li class=\"step-item\">\n        <div class=\"step-content\">Press the Home button on your remote</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Navigate to the app store on your TV (Samsung Apps, LG Content Store, etc.)</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Search for and install the \"Smart IPTV\" app</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open the Smart IPTV app</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Navigate to Settings > Configuration</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter your M3U URL or scan the QR code provided above</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Save your settings and restart the app</div>\n      </li>\n    </ol>\n    `;\n\n    const deviceSpecificTip = `For the best streaming experience on your Smart TV, we recommend connecting directly to your router with an Ethernet cable instead of using Wi-Fi for more stable streaming.`;\n\n    return createBaseEmailTemplate(\n        'smart_tv',\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        deviceSpecificInstructions,\n        deviceSpecificTip,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// src/utils/email/fire-stick.ts\nimport { createBaseEmailTemplate } from './base-template';\n\n/**\n * Builds a Fire Stick specific email template\n */\nexport function buildFireStickEmailTemplate(\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const deviceSpecificInstructions = `\n    <ol class=\"steps-list\">\n      <li class=\"step-item\">\n        <div class=\"step-content\">From your Fire Stick home screen, search for and install the \"Downloader\" app</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open the Downloader app and enter: bit.ly/iptv-player</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Follow the prompts to install the IPTV player</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open the newly installed IPTV player</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Select \"Add Playlist\" > \"Add M3U URL\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter the M3U URL shown above or scan the QR code</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Name your playlist (e.g., \"My Subscription\")</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Save and enjoy your content</div>\n      </li>\n    </ol>\n    `;\n\n    const deviceSpecificTip = `To navigate your Fire Stick faster, press and hold the Home button on your remote to access shortcuts, and keep your Fire Stick updated for the best streaming performance.`;\n\n    return createBaseEmailTemplate(\n        'fire_stick',\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        deviceSpecificInstructions,\n        deviceSpecificTip,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// src/utils/email/android-box.ts\nimport { createBaseEmailTemplate } from './base-template';\n\n/**\n * Builds an Android Box specific email template\n */\nexport function buildAndroidBoxEmailTemplate(\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const deviceSpecificInstructions = `\n    <ol class=\"steps-list\">\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open the Google Play Store on your Android Box</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Search for and install \"IPTV Smarters Pro\" or \"TiviMate\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open the installed app</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Select \"Add Playlist\" or \"Add New Playlist\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Choose \"Add M3U URL\" or \"Add URL\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter your playlist URL with your username and password (shown above) or scan the QR code</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Name your playlist (e.g., \"My IPTV\")</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Save and enjoy your content</div>\n      </li>\n    </ol>\n    `;\n\n    const deviceSpecificTip = `For best performance, connect your Android Box via Ethernet instead of Wi-Fi if possible, and periodically restart your device to clear cache and improve streaming quality.`;\n\n    return createBaseEmailTemplate(\n        'android_box',\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        deviceSpecificInstructions,\n        deviceSpecificTip,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// src/utils/email/ios.ts\nimport { createBaseEmailTemplate } from './base-template';\n\n/**\n * Builds an iOS specific email template\n */\nexport function buildIosEmailTemplate(\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const deviceSpecificInstructions = `\n    <ol class=\"steps-list\">\n      <li class=\"step-item\">\n        <div class=\"step-content\">Install \"IPTV Smarters Pro\" from the App Store</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open the IPTV Smarters Pro app</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Tap on \"Add New User\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter a name for your subscription (e.g., \"My Subscription\")</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Select \"M3U URL\" as input type</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter your M3U URL or scan the QR code provided above</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Tap \"Add User\" to save</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Your channels will now load automatically</div>\n      </li>\n    </ol>\n    `;\n\n    const deviceSpecificTip = `For iOS devices, make sure to keep the app updated to ensure compatibility with the latest iOS versions. You can also use AirPlay to mirror your screen to Apple TV for a bigger viewing experience.`;\n\n    return createBaseEmailTemplate(\n        'ios',\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        deviceSpecificInstructions,\n        deviceSpecificTip,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// src/utils/email/android-phone.ts\nimport { createBaseEmailTemplate } from './base-template';\n\n/**\n * Builds an Android Phone specific email template\n */\nexport function buildAndroidPhoneEmailTemplate(\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const deviceSpecificInstructions = `\n    <ol class=\"steps-list\">\n      <li class=\"step-item\">\n        <div class=\"step-content\">Install \"IPTV Smarters Pro\" from Google Play Store</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open the app and tap \"Add User\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter a name for your profile (e.g., \"My Subscription\")</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Choose \"M3U URL\" for playlist type</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter your M3U URL or simply scan the QR code above</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Save your configuration</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Your channels will load automatically</div>\n      </li>\n    </ol>\n    `;\n\n    const deviceSpecificTip = `For casting to a TV, make sure both devices are on the same Wi-Fi network. Use landscape mode for the best viewing experience, and consider using headphones for better audio when watching in public places.`;\n\n    return createBaseEmailTemplate(\n        'android_phone',\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        deviceSpecificInstructions,\n        deviceSpecificTip,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// src/utils/email/web-browser.ts\nimport { createBaseEmailTemplate } from './base-template';\n\n/**\n * Builds a Web Browser specific email template\n */\nexport function buildWebBrowserEmailTemplate(\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const deviceSpecificInstructions = `\n    <ol class=\"steps-list\">\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open your preferred web browser (Chrome, Firefox, Safari, etc.)</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Visit: <strong>http://watch.blancosphere.com</strong></div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter your username: <strong>${username}</strong></div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter your password: <strong>${password}</strong></div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Click \"Sign In\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Use the navigation menu to browse channels by category</div>\n      </li>\n    </ol>\n    `;\n\n    const deviceSpecificTip = `For the best web browsing experience, use Chrome, Firefox, or Edge for optimal compatibility. Bookmark the page for easy access in the future, and use full-screen mode (F11 on most browsers) for immersive viewing.`;\n\n    return createBaseEmailTemplate(\n        'web_browser',\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        deviceSpecificInstructions,\n        deviceSpecificTip,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// src/utils/email/mag-box.ts\nimport { createBaseEmailTemplate } from './base-template';\n\n/**\n * Builds a MAG Box specific email template\n */\nexport function buildMagBoxEmailTemplate(\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const deviceSpecificInstructions = `\n    <ol class=\"steps-list\">\n      <li class=\"step-item\">\n        <div class=\"step-content\">Power on your MAG box</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Go to the Settings menu</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Select \"System Settings\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Navigate to \"Servers\" or \"Portal Settings\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter the portal URL: <strong>http://${serverDomain}/c/</strong></div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">If prompted, restart your MAG box</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Your channels should now load automatically</div>\n      </li>\n    </ol>\n    `;\n\n    const deviceSpecificTip = `Your MAG box is already registered in our system. For optimal performance, keep your MAG box firmware updated, and use a wired Ethernet connection rather than Wi-Fi when possible. If you change your MAG box, please contact support.`;\n\n    return createBaseEmailTemplate(\n        'mag_box',\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        deviceSpecificInstructions,\n        deviceSpecificTip,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// src/utils/email/other.ts\nimport { createBaseEmailTemplate } from './base-template';\n\n/**\n * Builds a generic template for any unspecified device type\n */\nexport function buildOtherDeviceEmailTemplate(\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const deviceSpecificInstructions = `\n    <ol class=\"steps-list\">\n      <li class=\"step-item\">\n        <div class=\"step-content\">Download and install an IPTV player app appropriate for your device</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Open the app and navigate to settings or configuration</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Look for an option like \"Add M3U Playlist\", \"Add Stream\", or \"Add Source\"</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Enter the M3U URL shown above or scan the QR code with your device</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Some apps may ask for separate username and password instead of a full URL</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Save your settings and restart the app if needed</div>\n      </li>\n      <li class=\"step-item\">\n        <div class=\"step-content\">Browse and enjoy your content</div>\n      </li>\n    </ol>\n    `;\n\n    const deviceSpecificTip = `If you need device-specific instructions or recommendations for IPTV player apps, please contact our support team. We can provide customized guidance for your particular setup.`;\n\n    return createBaseEmailTemplate(\n        'other',\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        deviceSpecificInstructions,\n        deviceSpecificTip,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// src/utils/email/index.ts\nimport { sendEmail } from './send-email';\nimport { buildSmartTvEmailTemplate } from './smart-tv';\nimport { buildFireStickEmailTemplate } from './fire-stick';\nimport { buildAndroidBoxEmailTemplate } from './android-box';\nimport { buildIosEmailTemplate } from './ios';\nimport { buildAndroidPhoneEmailTemplate } from './android-phone';\nimport { buildWebBrowserEmailTemplate } from './web-browser';\nimport { buildMagBoxEmailTemplate } from './mag-box';\nimport { buildOtherDeviceEmailTemplate } from './other';\n\nexport { sendEmail };\n\n// Map device types to their builders\nconst emailBuilders: Record<string, Function> = {\n    'smart_tv': buildSmartTvEmailTemplate,\n    'fire_stick': buildFireStickEmailTemplate,\n    'android_box': buildAndroidBoxEmailTemplate,\n    'ios': buildIosEmailTemplate,\n    'android_phone': buildAndroidPhoneEmailTemplate,\n    'web_browser': buildWebBrowserEmailTemplate,\n    'mag_box': buildMagBoxEmailTemplate,\n    'other': buildOtherDeviceEmailTemplate\n};\n\n/**\n * Main function to build email for any device type.\n * This maintains the same interface as your original function.\n */\nexport function buildEnhancedEmailBody(\n    deviceType: string,\n    username: string,\n    password: string,\n    region: string,\n    subscriptionLength: string,\n    isRenewal: boolean,\n    portalUrl?: string,\n    firstName?: string,\n    serverDomain: string = \"iptv.blancosphere.com\"\n): string {\n    const builder = emailBuilders[deviceType] || emailBuilders['other'];\n    return builder(\n        username,\n        password,\n        region,\n        subscriptionLength,\n        isRenewal,\n        portalUrl,\n        firstName,\n        serverDomain\n    );\n}", "// handlers/activation.ts\nimport { Env, UserCredentials } from '../types';\nimport {\n    createErrorResponse,\n    createJsonResponse,\n    extractCredentials,\n    fetchFromActivationPanel,\n    formatDeviceName,\n    logEvent,\n    parseDeviceTypes,\n    validateDeviceTypes,\n    validateRequiredParams\n} from '../utils/helpers';\nimport { REGIONAL_OPTIONS } from '../config';\nimport { buildEnhancedEmailBody, sendEmail } from '../utils/email';\n\n/**\n * Activates or renews a subscription after Stripe payment success.\n * Sends individual emails with device-specific instructions.\n */\nexport async function handleActivate(request: Request, env: Env): Promise<Response> {\n    try {\n        const url = new URL(request.url);\n        const subscriptionLength = url.searchParams.get(\"subscriptionLength\");\n        const region = url.searchParams.get(\"region\");\n        const customer_id = url.searchParams.get(\"customer_id\");\n        const deviceTypesParam = url.searchParams.get(\"device_types\");\n        const user_email = url.searchParams.get(\"user_email\");\n        const checkoutToken = url.searchParams.get(\"checkoutToken\");\n        const firstName = url.searchParams.get(\"firstName\");\n\n        const validationError = validateRequiredParams({\n            subscriptionLength,\n            region,\n            customer_id,\n            deviceTypesParam,\n            user_email,\n            checkoutToken,\n        });\n        if (validationError) return createErrorResponse(validationError, 400);\n\n        // Parse and validate device types.\n        const deviceTypes = parseDeviceTypes(deviceTypesParam!);\n        const deviceTypesError = validateDeviceTypes(deviceTypes);\n        if (deviceTypesError) return createErrorResponse(deviceTypesError, 400);\n\n        // Validate the checkout token.\n        const tokenData = await env.KV.get(`checkout:${checkoutToken}`);\n        if (!tokenData) return createErrorResponse(\"Invalid or expired checkout token\", 400);\n        await env.KV.delete(`checkout:${checkoutToken}`);\n\n        // Map region to bouquet configuration.\n        const bouquetConfig = REGIONAL_OPTIONS[region!];\n        if (!bouquetConfig) return createErrorResponse(`Invalid region: ${region}`, 400);\n\n        // Calculate expiry date using a simple month approximation.\n        const expiryDate = new Date(Date.now() + parseInt(subscriptionLength!) * 30 * 24 * 60 * 60 * 1000).toISOString();\n\n        // Check for existing user credentials.\n        const kvKey = `user:${customer_id}`;\n        const stored = await env.KV.get(kvKey);\n        let username: string | null = null;\n        let password: string | null = null;\n        let isRenewal = false;\n\n        if (stored) {\n            try {\n                const { username: storedUser, password: storedPass } = JSON.parse(stored) as UserCredentials;\n                if (!storedUser || !storedPass) throw new Error(\"Invalid stored credentials\");\n\n                // Attempt renewal.\n                const renewUrl = `https://activationpanel.net/api/api.php?action=renew&type=m3u&username=${encodeURIComponent(storedUser)}&password=${encodeURIComponent(storedPass)}&sub=${subscriptionLength}&api_key=${env.ACTIVATION_PANEL_KEY}`;\n                const renewData = await fetchFromActivationPanel(renewUrl);\n                if (renewData.status !== \"true\") throw new Error(`Renewal failed: ${renewData.message || \"Unknown error\"}`);\n                isRenewal = true;\n                username = storedUser;\n                password = storedPass;\n                await logEvent(env, \"subscription_renewed\", {\n                    customer_id,\n                    user_email,\n                    subscriptionLength,\n                    region,\n                    device_types: deviceTypes,\n                });\n            } catch (error) {\n                console.error(\"Error renewing existing subscription:\", error);\n                await logEvent(env, \"renewal_failed\", {\n                    customer_id,\n                    error: error instanceof Error ? error.message : String(error),\n                });\n                // Fall through to create a new subscription.\n            }\n        }\n\n        // If no valid credentials, create a new M3U subscription.\n        if (!username || !password) {\n            const createUrl = `https://activationpanel.net/api/api.php?action=new&type=m3u&sub=${subscriptionLength}&pack=${encodeURIComponent(bouquetConfig)}&api_key=${env.ACTIVATION_PANEL_KEY}`;\n\n            // Log the URL being requested\n            console.log(\"Creating new subscription with URL:\", createUrl);\n\n            const result = await fetchFromActivationPanel(createUrl);\n\n            // Log the full response from the activation panel\n            console.log(\"Activation Panel Response:\", result);\n\n            if (String(result.status).toLowerCase() !== \"true\" || !result.url) {\n                await logEvent(env, \"activation_failed\", {\n                    customer_id,\n                    error: result.message || \"Activation failed - no URL returned\",\n                    raw_response: result\n                });\n                return createErrorResponse(result.message || \"Activation failed\", 500);\n            }\n\n            const credentials = extractCredentials(result.url);\n\n            if (!credentials) {\n                await logEvent(env, \"credential_extraction_failed\", {\n                    customer_id,\n                    m3u_url: result.url\n                });\n                return createErrorResponse(\"Failed to extract credentials from activation response\", 500);\n            }\n\n            username = credentials.username;\n            password = credentials.password;\n\n            await logEvent(env, \"new_subscription_created\", {\n                customer_id,\n                user_email,\n                subscriptionLength,\n                region,\n                device_types: deviceTypes,\n                username,\n                m3u_url: result.url\n            });\n        }\n\n        // Store the new or updated credentials.\n        const updatedData: UserCredentials = {\n            username,\n            password,\n            created_at: new Date().toISOString(),\n            subscriptionLength: subscriptionLength as UserCredentials[\"subscriptionLength\"],\n            region: region as UserCredentials[\"region\"],\n            expiry_date: expiryDate,\n            device_types: deviceTypes,\n            user_email: user_email as string,\n            status: \"active\",\n            last_renewed: isRenewal ? new Date().toISOString() : undefined,\n        };\n        await env.KV.put(kvKey, JSON.stringify(updatedData));\n\n        // Send individual device-specific emails.\n        let emailSuccessCount = 0;\n        let emailFailureCount = 0;\n        const serverDomain = \"iptv.blancosphere.com\";\n\n        for (const deviceType of deviceTypes) {\n            try {\n                const deviceName = formatDeviceName(deviceType);\n                const subject = isRenewal\n                    ? `Your IPTV Subscription Renewed - ${deviceName} Setup`\n                    : `Welcome to Blancosphere - ${deviceName} Setup`;\n                const emailHtml = buildEnhancedEmailBody(\n                    deviceType,\n                    username,\n                    password,\n                    region as string,\n                    subscriptionLength as string,\n                    isRenewal,\n                    undefined, // portalUrl (optional)\n                    undefined, // firstName (optional)\n                    serverDomain\n                );\n                await sendEmail(env, user_email as string, subject, emailHtml);\n                await logEvent(env, \"email_sent\", { device_types: deviceTypes, customer_id, user_email, isRenewal });\n                emailSuccessCount++;\n                if (deviceTypes.length > 1 && deviceType !== deviceTypes[deviceTypes.length - 1]) {\n                    await new Promise(resolve => setTimeout(resolve, 500)); // Delay to prevent rate limiting.\n                }\n            } catch (emailErr) {\n                console.error(`Failed to send email for ${deviceType}:`, emailErr);\n                await logEvent(env, \"email_failed\", {\n                    device_types: deviceTypes,\n                    customer_id,\n                    user_email,\n                    error: emailErr instanceof Error ? emailErr.message : String(emailErr),\n                });\n                emailFailureCount++;\n            }\n        }\n\n        await logEvent(env, \"multi_device_email_complete\", {\n            customer_id,\n            total_devices: deviceTypes.length,\n            success_count: emailSuccessCount,\n            failure_count: emailFailureCount,\n        });\n\n        return createJsonResponse({\n            success: true,\n            renewed: isRenewal,\n            message: isRenewal\n                ? `Your subscription has been renewed successfully. Check your email for setup instructions for your ${deviceTypes.length} device(s).`\n                : `Your subscription has been activated successfully. Check your email for setup instructions for your ${deviceTypes.length} device(s).`,\n            username,\n            expiry_date: expiryDate,\n            // Not returning the password for security.\n        });\n    } catch (err) {\n        console.error(\"Unexpected error in handleActivate:\", err);\n        return createErrorResponse(`Internal server error: ${err instanceof Error ? err.message : String(err)}`, 500);\n    }\n}", "// handlers/status.ts\nimport { Env, UserCredentials } from \"../types\";\nimport {\n    createErrorResponse,\n    createJsonResponse,\n    validateApiKey,\n} from \"../utils/helpers\";\n\n/**\n * Handles account status checking.\n * Secured via STREAMVAULT_ADMIN_KEY using x-api-key header.\n */\nexport async function handleCheckStatus(request: Request, env: Env): Promise<Response> {\n    // \uD83D\uDD10 Step 1: Validate API Key\n    if (!validateApiKey(request, env)) {\n        return new Response(JSON.stringify({ error: \"Unauthorized\" }), {\n            status: 401,\n            headers: { \"Content-Type\": \"application/json\" },\n        });\n    }\n\n    try {\n        // \u2705 Step 2: Parse query params\n        const url = new URL(request.url);\n        const customer_id = url.searchParams.get(\"customer_id\");\n\n        if (!customer_id) {\n            return createErrorResponse(\"Missing customer_id parameter\", 400);\n        }\n\n        // \uD83D\uDD0D Step 3: Fetch user subscription from KV\n        const kvKey = `user:${customer_id}`;\n        const stored = await env.KV.get(kvKey);\n        if (!stored) {\n            return createJsonResponse({\n                status: \"not_found\",\n                message: \"No subscription found for this customer ID\",\n            });\n        }\n\n        // \uD83E\uDDE0 Step 4: Format and return only safe data\n        const userData = JSON.parse(stored) as UserCredentials;\n        const safeUserData = {\n            username: userData.username,\n            region: userData.region,\n            subscriptionLength: userData.subscriptionLength,\n            expiry_date: userData.expiry_date,\n            status: userData.status,\n            device_types: userData.device_types,\n            created_at: userData.created_at,\n            last_renewed: userData.last_renewed,\n        };\n\n        return createJsonResponse({ status: \"success\", subscription: safeUserData });\n    } catch (err) {\n        console.error(\"Error checking status:\", err);\n        return createErrorResponse(\n            `Error checking status: ${err instanceof Error ? err.message : String(err)}`,\n            500\n        );\n    }\n}", "// handlers/instructions.ts\nimport { Env } from '../types';\nimport { createErrorResponse, createJsonResponse } from '../utils/helpers';\nimport { DEVICE_INSTRUCTIONS } from '../config';\n\n/**\n * Handles device instructions retrieval.\n */\nexport async function handleDeviceInstructions(request: Request, env: Env): Promise<Response> {\n    try {\n        const url = new URL(request.url);\n        const device_types = url.searchParams.get(\"device_types\");\n        if (!device_types) {\n            return createJsonResponse({\n                status: \"success\",\n                available_devices: Object.keys(DEVICE_INSTRUCTIONS),\n                instructions: DEVICE_INSTRUCTIONS,\n            });\n        }\n        if (!DEVICE_INSTRUCTIONS[device_types]) {\n            return createErrorResponse(`Unknown device type: ${device_types}`, 404);\n        }\n        return createJsonResponse({\n            status: \"success\",\n            device_types,\n            instructions: DEVICE_INSTRUCTIONS[device_types],\n        });\n    } catch (err) {\n        console.error(\"Error retrieving device instructions:\", err);\n        return createErrorResponse(`Error retrieving device instructions: ${err instanceof Error ? err.message : String(err)}`, 500);\n    }\n}", "// handlers/webhooks.ts\nimport { Env, UserCredentials } from '../types';\nimport { createErrorResponse, logEvent, verifyStripeWebhookSignature } from '../utils/helpers';\nimport { sendEmail } from '../utils/email';\n\n/**\n * Handles Stripe webhook events.\n */\nexport async function handleStripeWebhook(request: Request, env: Env): Promise<Response> {\n    try {\n        const signature = request.headers.get(\"stripe-signature\");\n        if (!signature) return createErrorResponse(\"Missing stripe-signature header\", 400);\n\n        const payload = await request.text();\n        const isValid = verifyStripeWebhookSignature(payload, signature, env.STRIPE_WEBHOOK_SECRET);\n        if (!isValid) {\n            await logEvent(env, \"webhook_invalid_signature\", { signature: signature.substring(0, 20) + \"...\" });\n            return createErrorResponse(\"Invalid webhook signature\", 403);\n        }\n\n        const event = JSON.parse(payload);\n        const eventType = event.type;\n        await logEvent(env, `webhook_${eventType}`, {\n            event_id: event.id,\n            object: event.data.object.object,\n        });\n\n        // Handle specific events\n        switch (eventType) {\n            case \"checkout.session.completed\": {\n                const session = event.data.object;\n                const customerId = session.metadata.customer_id;\n                const subscriptionId = session.subscription;\n                if (customerId && subscriptionId) {\n                    const kvKey = `user:${customerId}`;\n                    const userData = await env.KV.get(kvKey);\n                    if (userData) {\n                        const userRecord = JSON.parse(userData) as UserCredentials;\n                        userRecord.subscription_id = subscriptionId;\n                        userRecord.stripe_customer_id = session.customer;\n                        await env.KV.put(kvKey, JSON.stringify(userRecord));\n                        await logEvent(env, \"subscription_id_updated\", { customer_id: customerId, subscription_id: subscriptionId });\n                    }\n                }\n                break;\n            }\n            case \"customer.subscription.deleted\": {\n                const subscription = event.data.object;\n                const subscriptionId = subscription.id;\n                console.log(`Subscription ${subscriptionId} was canceled`);\n                await logEvent(env, \"subscription_canceled\", { subscription_id: subscriptionId });\n                break;\n            }\n            case \"invoice.payment_succeeded\": {\n                const invoice = event.data.object;\n                const subscriptionId = invoice.subscription;\n                await logEvent(env, \"payment_succeeded\", {\n                    subscription_id: subscriptionId,\n                    amount: invoice.amount_paid,\n                    currency: invoice.currency,\n                });\n                break;\n            }\n            case \"invoice.payment_failed\": {\n                const invoice = event.data.object;\n                const customerEmail = invoice.customer_email;\n                const subscriptionId = invoice.subscription;\n                if (customerEmail) {\n                    try {\n                        const emailHtml = `\n              <h1>Payment Failed</h1>\n              <p>We were unable to process your payment for your IPTV subscription.</p>\n              <p>Please update your payment method or contact support.</p>\n              <p>Your subscription will be paused if payment is not received within 7 days.</p>\n            `;\n                        await sendEmail(env, customerEmail, \"Payment Failed - Action Required\", emailHtml);\n                    } catch (error) {\n                        console.error(\"Failed to send payment failure email:\", error);\n                    }\n                }\n                await logEvent(env, \"payment_failed\", { subscription_id: subscriptionId, customer_email: customerEmail });\n                break;\n            }\n            default:\n                console.log(`Unhandled webhook event type: ${eventType}`);\n        }\n\n        return new Response(\"Webhook received\", { status: 200 });\n    } catch (err) {\n        console.error(\"Error processing webhook:\", err);\n        await logEvent(env, \"webhook_processing_error\", { error: err instanceof Error ? err.message : String(err) });\n        return createErrorResponse(`Webhook processing error: ${err instanceof Error ? err.message : String(err)}`, 500);\n    }\n}", "// handlers/cors.ts\n\n/**\n * Handles CORS preflight (OPTIONS) requests.\n */\nexport function handleCorsPreflightRequest(): Response {\n    return new Response(null, {\n        status: 204,\n        headers: {\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Access-Control-Allow-Methods\": \"GET, POST, OPTIONS\",\n            \"Access-Control-Allow-Headers\": \"Content-Type, Authorization, stripe-signature\",\n            \"Access-Control-Max-Age\": \"86400\",\n        },\n    });\n}", "// src/handlers/debug.ts\nimport { Env } from '../types';\nimport { buildEnhancedEmailBody } from '../utils/email';\n\n/**\n * Debug handler for previewing email templates\n * IMPORTANT: For development use only!\n */\nexport async function handleDebug(request: Request, env: Env): Promise<Response> {\n    // Get parameters from URL\n    const url = new URL(request.url);\n\n    // Extract all parameters with defaults\n    const deviceType = url.searchParams.get('device_type') || 'smart_tv';\n    const username = url.searchParams.get('username') || 'test_user123';\n    const password = url.searchParams.get('password') || 'SecurePass456!';\n    const region = url.searchParams.get('region') || 'north_america';\n    const subscriptionLength = url.searchParams.get('subscription_length') || '12';\n    const isRenewal = url.searchParams.get('is_renewal') === 'true';\n    const firstName = url.searchParams.get('first_name') || 'Test User';\n    const serverDomain = url.searchParams.get('server_domain') || 'iptv.blancosphere.com';\n    const portalUrl = url.searchParams.get('portal_url') || 'https://portal.blancosphere.com';\n\n    // Generate email HTML\n    try {\n        const emailHtml = buildEnhancedEmailBody(\n            deviceType,\n            username,\n            password,\n            region,\n            subscriptionLength,\n            isRenewal,\n            portalUrl,\n            firstName,\n            serverDomain\n        );\n\n        // Return the email HTML\n        return new Response(emailHtml, {\n            headers: { 'Content-Type': 'text/html' }\n        });\n    } catch (error) {\n        // Return error details\n        return new Response(`Error generating email template: ${error instanceof Error ? error.message : String(error)}`, {\n            status: 500,\n            headers: { 'Content-Type': 'text/plain' }\n        });\n    }\n}", "// src/index.ts\nimport { Env } from './types';\nimport { createErrorResponse, createJsonResponse } from './utils/helpers';\nimport { handleCreateCheckout } from './handlers/checkout';\nimport { handleActivate } from './handlers/activation';\nimport { handleCheckStatus } from './handlers/status';\nimport { handleDeviceInstructions } from './handlers/instructions';\nimport { handleStripeWebhook } from './handlers/webhooks';\nimport { handleCorsPreflightRequest } from './handlers/cors';\nimport { handleDebug } from './handlers/debug';          // \u2190 NEW\n\nexport default {\n\tasync fetch(request: Request, env: Env): Promise<Response> {\n\t\ttry {\n\t\t\tconst url    = new URL(request.url);\n\t\t\tconst method = request.method;\n\n\t\t\t// ---------------------------------------------------------------------\n\t\t\t// Debug route \u2014 no auth required, great for quick local tests\n\t\t\t// ---------------------------------------------------------------------\n\t\t\tif (url.pathname === '/debug/email') {\n\t\t\t\treturn await handleDebug(request, env);\n\t\t\t}\n\n\t\t\t// ---------------------------------------------------------------------\n\t\t\t// CORS pre\u2011flight\n\t\t\t// ---------------------------------------------------------------------\n\t\t\tif (method === 'OPTIONS') return handleCorsPreflightRequest();\n\n\t\t\t// ---------------------------------------------------------------------\n\t\t\t// Main API routes\n\t\t\t// ---------------------------------------------------------------------\n\t\t\tswitch (url.pathname) {\n\t\t\t\tcase '/create-checkout':\n\t\t\t\t\tif (method === 'POST') return await handleCreateCheckout(request, env);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '/activate':\n\t\t\t\t\tif (method === 'GET')  return await handleActivate(request, env);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '/webhook':\n\t\t\t\t\tif (method === 'POST') return await handleStripeWebhook(request, env);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '/check-status':\n\t\t\t\t\tif (method === 'GET')  return await handleCheckStatus(request, env);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '/device-instructions':\n\t\t\t\t\tif (method === 'GET')  return await handleDeviceInstructions(request, env);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '/health-check':\n\t\t\t\t\treturn createJsonResponse({\n\t\t\t\t\t\tstatus:   'healthy',\n\t\t\t\t\t\tversion:  '1.1.0',\n\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\t// ---------------------------------------------------------------------\n\t\t\t// Fallback 404\n\t\t\t// ---------------------------------------------------------------------\n\t\t\treturn createErrorResponse(`Not Found: ${url.pathname} with method ${method}`, 404);\n\t\t} catch (err) {\n\t\t\tconsole.error('Unexpected error in main handler:', err);\n\t\t\treturn createErrorResponse(\n\t\t\t\t`Internal server error: ${err instanceof Error ? err.message : String(err)}`,\n\t\t\t\t500,\n\t\t\t);\n\t\t}\n\t},\n};", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/Users/yousef/IdeaProjects/streamvault/src/index.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/Users/yousef/IdeaProjects/streamvault/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/Users/yousef/IdeaProjects/streamvault/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/Users/yousef/IdeaProjects/streamvault/src/index.ts\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/Users/yousef/IdeaProjects/streamvault/.wrangler/tmp/bundle-9lBNsX/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/Users/yousef/IdeaProjects/streamvault/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/Users/yousef/IdeaProjects/streamvault/.wrangler/tmp/bundle-9lBNsX/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/Users/yousef/IdeaProjects/streamvault/.wrangler/tmp/bundle-9lBNsX/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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AAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;A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",
  "names": ["jsonError"]
}
